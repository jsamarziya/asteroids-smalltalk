<HTML>
<!-- This file was generated by st2html.pl, version 1.25 -->

<!-- http://www.cs.washington.edu/homes/sam/projects/src/st2html/st2html.pl -->
<HEAD>
<TITLE>Smalltalk class category: Asteroids</TITLE>
</HEAD>
<BODY>
<H2>Category name: Asteroids</H2>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class Asteroid
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Sprite
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'scale '<br>
<spacer type=horizontal size=20>classVariableNames: 'LargeScale MediumScale SmallScale '<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>The asteroid sprite.<p>
Instance variables:<br>
<spacer type=horizontal size=20>scale &lt;Number&gt; size of the asteroid<p>
Class variables:<br>
<spacer type=horizontal size=20>LargeScale &lt;Number&gt; scale of a large asteroid (constant)<br>
<spacer type=horizontal size=20>MediumScale &lt;Number&gt; scale of a medium asteroid (constant)<br>
<spacer type=horizontal size=20>SmallScale &lt;Number&gt; scale of a small asteroid (constant)<br>
</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>pointValue<br></b>
<spacer type=horizontal size=20><i>"answer the point value of the receiver"</i><p>
<spacer type=horizontal size=20>scale = LargeScale ifTrue: [^20].<br>
<spacer type=horizontal size=20>scale = MediumScale ifTrue: [^50].<br>
<spacer type=horizontal size=20>scale = SmallScale ifTrue: [^100].<br>
<spacer type=horizontal size=20>self error: 'I dont know what size I am'</dd>
<p><hr width=50 align=left><p>
<dd>
<b>scale<br></b>
<spacer type=horizontal size=20><i>"answer the scale of the receiver"</i><p>
<spacer type=horizontal size=20>^scale</dd>
<p><hr width=50 align=left><p>
<dd>
<b>scale: s <br></b>
<spacer type=horizontal size=20><i>"set the scale of the receiver"</i><p>
<spacer type=horizontal size=20>scale := s</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>collision detection</b></u><p>
<dd>
<b>checkForCollision<br></b>
<spacer type=horizontal size=20><i>"check for collisions with the sprites in the world"</i><br>
<spacer type=horizontal size=20><i>"asteroids don't need to check for collisions. if another sprite runs into an asteroid, we'll detect it when <br>
<spacer type=horizontal size=20>that sprite checks for collisions."</i><p>
<spacer type=horizontal size=20>^nil</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isCollidingWith: aSprite <br></b>
<spacer type=horizontal size=20><i>"returns true if the receiver is colliding with aSprite"</i><br>
<spacer type=horizontal size=20><i>"Asteroids don't collide into anything. Other things collide into asteroids."</i><p>
<spacer type=horizontal size=20>^false</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>newShape<br></b>
<spacer type=horizontal size=20><i>"create a new shape for the receiver"</i><p>
<spacer type=horizontal size=20>| angle list |<br>
<spacer type=horizontal size=20>angle := RandomNumber lessThan: 0.5.<br>
<spacer type=horizontal size=20>list := OrderedCollection new.<br>
<spacer type=horizontal size=20>[angle &lt; 6.28319]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[list add: (Point r: scale - (RandomNumber lessThan: scale * 0.4) theta: angle).<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>angle := angle + (RandomNumber between: 0.2 and: 0.4)].<br>
<spacer type=horizontal size=20>list add: list first.<br>
<spacer type=horizontal size=20>shape := Polyline vertices: list</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>transforming</b></u><p>
<dd>
<b>addFlamingBits<br></b>
<spacer type=horizontal size=20><i>"adds a collection of sprites that are the exploded remains of the receiver to the world"</i><br>
<spacer type=horizontal size=20><i>"we also add some smaller asteroids, if applicable"</i><p>
<spacer type=horizontal size=20>super addFlamingBits.<br>
<spacer type=horizontal size=20>scale = SmallScale ifFalse: [1 to: 2 do: [:a | world add: (Asteroid from: self)]]</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>class initialization</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"set up scale constants"</i><p>
<spacer type=horizontal size=20>Asteroids initialize.<br>
<spacer type=horizontal size=20>LargeScale := 100 * Asteroids spriteScaleFactor.<br>
<spacer type=horizontal size=20>MediumScale := 30 * Asteroids spriteScaleFactor.<br>
<spacer type=horizontal size=20>SmallScale := 10 * Asteroids spriteScaleFactor</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>from: parent <br></b>
<spacer type=horizontal size=20><i>"answers a new asteroid that is one size smaller than the parent. Raises an exception if parent is <br>
<spacer type=horizontal size=20>SmallScale"</i><p>
<spacer type=horizontal size=20>| size child |<br>
<spacer type=horizontal size=20>parent scale = LargeScale<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [size := MediumScale]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [parent scale = MediumScale<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [size := SmallScale]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [self error: 'Asteroid from: called with a small parent']].<br>
<spacer type=horizontal size=20>child := Asteroid new: size at: parent location + (RandomNumber between: parent scale negated @ parent scale negated and: parent scale @ parent scale).<br>
<spacer type=horizontal size=20>child velocity: (Point r: parent velocity r + (RandomNumber between: 3.0 and: 8.0) theta: parent velocity theta + (RandomNumber between: -1.0 and: 1.0)).<br>
<spacer type=horizontal size=20>^child</dd>
<p><hr width=50 align=left><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"answers a new large asteroid."</i><p>
<spacer type=horizontal size=20>^self new: LargeScale at: #offscreen</dd>
<p><hr width=50 align=left><p>
<dd>
<b>new: size at: location <br></b>
<spacer type=horizontal size=20><i>"answers a new asteroid at a given location, which may be a Point or may be #offscreen."</i><p>
<spacer type=horizontal size=20>| newAsteroid maxAngularVelocity maxXSpeed maxYSpeed |<br>
<spacer type=horizontal size=20>newAsteroid := super new initialize.<br>
<spacer type=horizontal size=20>newAsteroid scale: size.<br>
<spacer type=horizontal size=20>newAsteroid newShape.<br>
<spacer type=horizontal size=20>newAsteroid moveTo: location.<br>
<spacer type=horizontal size=20>maxAngularVelocity := 4 / size.<br>
<spacer type=horizontal size=20>maxXSpeed := 125 / size.<br>
<spacer type=horizontal size=20>maxYSpeed := 250 / size.<br>
<spacer type=horizontal size=20>newAsteroid angular_speed: (RandomNumber between: maxAngularVelocity negated and: maxAngularVelocity).<br>
<spacer type=horizontal size=20>newAsteroid velocity: (RandomNumber between: maxXSpeed negated and: maxXSpeed)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>@ (RandomNumber between: maxYSpeed negated and: maxYSpeed).<br>
<spacer type=horizontal size=20>^newAsteroid</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class Asteroids
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'win display keyboard_handler player highScores thrustKey turnLeftKey turnRightKey hyperspaceKey fireKey '<br>
<spacer type=horizontal size=20>classVariableNames: 'SpriteScaleFactor WindowBounds WindowSize '<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>The arcade classic, Asteroids.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>win &lt;ScheduledWindow&gt; the game window<br>
<spacer type=horizontal size=20>display &lt;DisplayManager&gt; the display manager that handles drawing into the window<br>
<spacer type=horizontal size=20>keyboard_handler &lt;KeyboardManager&gt; the keyboard manager that handles key events<br>
<spacer type=horizontal size=20>player &lt;Player&gt; the current player<br>
<spacer type=horizontal size=20>highScores &lt;HighScoreList&gt; list of high scores<br>
<spacer type=horizontal size=20>thrustKey &lt;Character&gt; The key pressed to accelerate<br>
<spacer type=horizontal size=20>turnLeftKey &lt;Character&gt; The key pressed to turn left<br>
<spacer type=horizontal size=20>turnRightKey &lt;Character&gt; The key pressed to turn right<br>
<spacer type=horizontal size=20>hyperspaceKey &lt;Character&gt; The key pressed to go into hyperspace<br>
<spacer type=horizontal size=20>fireKey &lt;Character&gt; The key pressed to fire a shot<p>
Class Variables:<br>
<spacer type=horizontal size=20>SpriteScaleFactor &lt;Number&gt; a scale constant used by game sprites<br>
<spacer type=horizontal size=20>WindowBounds &lt;Rectangle&gt; the bounds of the window<br>
<spacer type=horizontal size=20>WindowSize &lt;Point&gt; the extent (width@height) of the window</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>display<br></b>
<spacer type=horizontal size=20><i>"answers the display manager associated with the receiver"</i><p>
<spacer type=horizontal size=20>^display</dd>
<p><hr width=50 align=left><p>
<dd>
<b>keyboard_handler<br></b>
<spacer type=horizontal size=20><i>"answers the keyboard manager associated with this game"</i><p>
<spacer type=horizontal size=20>^keyboard_handler</dd>
<p><hr width=50 align=left><p>
<dd>
<b>player<br></b>
<spacer type=horizontal size=20><i>"answers the receiver's current player"</i><p>
<spacer type=horizontal size=20>^player</dd>
<p><hr width=50 align=left><p>
<dd>
<b>window<br></b>
<spacer type=horizontal size=20><i>"answers the receiver's window"</i><p>
<spacer type=horizontal size=20>^win</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>demo screens</b></u><p>
<dd>
<b>addTitle<br></b>
<spacer type=horizontal size=20><i>"add the title to the background."</i><p>
<spacer type=horizontal size=20>| title |<br>
<spacer type=horizontal size=20>title := ComposedText withText: 'A S T E R O I D S'.<br>
<spacer type=horizontal size=20>display background add: title at: Asteroids windowSize x - title width / 2 @ 100</dd>
<p><hr width=50 align=left><p>
<dd>
<b>beginDemo<br></b>
<spacer type=horizontal size=20><i>"begin the demo"</i><p>
<spacer type=horizontal size=20>| demoLoopProcess |<br>
<spacer type=horizontal size=20>demoLoopProcess := [self demoLoop] fork.<br>
<spacer type=horizontal size=20>display bgcolor: ColorValue black.<br>
<spacer type=horizontal size=20>keyboard_handler add: [self quit]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: $q.<br>
<spacer type=horizontal size=20>keyboard_handler<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>add: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[demoLoopProcess terminate.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self quit]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: Character esc.<br>
<spacer type=horizontal size=20>keyboard_handler<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>add: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[demoLoopProcess terminate.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self removeDemoKeys.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self play]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: Character cr.<br>
<spacer type=horizontal size=20>keyboard_handler<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>add: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[demoLoopProcess terminate.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self removeDemoKeys.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self play]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: Character space</dd>
<p><hr width=50 align=left><p>
<dd>
<b>demoLoop<br></b>
<spacer type=horizontal size=20><i>"slideshow the demo screens."</i><p>
<spacer type=horizontal size=20>| delayBetweenScreens screens |<br>
<spacer type=horizontal size=20>delayBetweenScreens := 8.<br>
<spacer type=horizontal size=20>screens := #(#displayHighScoresScreen #displayPointScheduleScreen #displayKeysScreen #displayHaikuScreen).<br>
<spacer type=horizontal size=20>[win isOpen]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: [screens<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[:s | <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>display bgcolor: ColorValue black.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self perform: s.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>display fadeIn.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(Delay forSeconds: delayBetweenScreens) wait.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>win isOpen ifFalse: [Processor terminateActive]]]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayHaikuScreen<br></b>
<spacer type=horizontal size=20><i>"display an Asteroids haiku"</i><p>
<spacer type=horizontal size=20>| haiku rect |<br>
<spacer type=horizontal size=20>display clearBackground.<br>
<spacer type=horizontal size=20>self addTitle.<br>
<spacer type=horizontal size=20>haiku := 'An Asteriods Haiku&lt;n&gt;&lt;n&gt;&lt;n&gt;Asteroids, chunks of&lt;n&gt;rock, floating, spinning in space&lt;n&gt;Watch out for E.T.''s' expandMacros asComposedText.<br>
<spacer type=horizontal size=20>haiku justified.<br>
<spacer type=horizontal size=20>display background add: haiku at: Asteroids windowSize x - haiku width / 2 @ (Asteroids windowSize y - haiku height / 2).<br>
<spacer type=horizontal size=20>rect := haiku preferredBounds scaledBy: 1.5.<br>
<spacer type=horizontal size=20>display background add: ((GraphicsAttributesWrapper on: rect asVisualComponent)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>attributes: (GraphicsAttributes new paint: ColorValue darkGray))<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>at: Asteroids windowSize x - rect width / 2 @ (Asteroids windowSize y - rect height / 2)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayHighScoresScreen<br></b>
<spacer type=horizontal size=20><i>"display the high scores"</i><p>
<spacer type=horizontal size=20>| highScoresText |<br>
<spacer type=horizontal size=20>highScoresText := highScores asComposedText justified.<br>
<spacer type=horizontal size=20>display clearBackground.<br>
<spacer type=horizontal size=20>self addTitle.<br>
<spacer type=horizontal size=20>display background add: highScoresText at: Asteroids windowSize x - highScoresText width / 2 @ 200</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayKeysScreen<br></b>
<spacer type=horizontal size=20><i>"display the key settings"</i><p>
<spacer type=horizontal size=20>| keyText fkeyText |<br>
<spacer type=horizontal size=20>keyText := ((String with: turnLeftKey)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>, '&lt;t&gt;&lt;t&gt;turn left&lt;n&gt;' , (String with: turnRightKey) , '&lt;t&gt;&lt;t&gt;turn right&lt;n&gt;' , (String with: thrustKey) , '&lt;t&gt;&lt;t&gt;thrust&lt;n&gt;' , 'tab' , '&lt;t&gt;&lt;t&gt;hyperspace&lt;n&gt;' , 'space' , '&lt;t&gt;fire&lt;n&gt;' , 'p&lt;t&gt;&lt;t&gt;pause') expandMacros asComposedText.<br>
<spacer type=horizontal size=20>fkeyText := '%&lt;F1%&gt; display level                                             %&lt;F2%&gt; display frame rate                          %&lt;F3%&gt; display update loop delay' expandMacros asComposedText centered.<br>
<spacer type=horizontal size=20>display clearBackground.<br>
<spacer type=horizontal size=20>self addTitle.<br>
<spacer type=horizontal size=20>display background add: keyText at: Asteroids windowSize x - keyText width / 2 @ 200.<br>
<spacer type=horizontal size=20>display background add: fkeyText at: Asteroids windowSize x - fkeyText width / 2 @ 550</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayPointScheduleScreen<br></b>
<spacer type=horizontal size=20><i>"display the point schedule"</i><p>
<spacer type=horizontal size=20>| pointSchedule |<br>
<spacer type=horizontal size=20>display clearBackground.<br>
<spacer type=horizontal size=20>self addTitle.<br>
<spacer type=horizontal size=20>pointSchedule := 'Small Asteroids&lt;t&gt;100 points&lt;n&gt;Medium Asteroids&lt;t&gt;50 points&lt;n&gt;Large Asteroids&lt;t&gt;20 points&lt;n&gt;Large Spacecraft&lt;t&gt;200 points&lt;n&gt;Small Spacecraft&lt;t&gt;1,000 points&lt;n&gt;&lt;n&gt;&lt;n&gt;&lt;n&gt;Bonus ship awarded every 10,000 points' expandMacros asComposedText.<br>
<spacer type=horizontal size=20>pointSchedule centered.<br>
<spacer type=horizontal size=20>display background add: pointSchedule at: Asteroids windowSize x - pointSchedule width / 2 @ 200</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>game play</b></u><p>
<dd>
<b>gameOver<br></b>
<spacer type=horizontal size=20><i>"the game has ended. ask for initials if a high score was achieved, and then start the demo again."</i><p>
<spacer type=horizontal size=20>self removePlayKeys.<br>
<spacer type=horizontal size=20>player die.<br>
<spacer type=horizontal size=20>display unpause.<br>
<spacer type=horizontal size=20>(Delay forSeconds: 3) wait.<br>
<spacer type=horizontal size=20>(highScores isHighScore: player score)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [self getInitials].<br>
<spacer type=horizontal size=20>(Delay forMilliseconds: 500) wait.<br>
<spacer type=horizontal size=20>self beginDemo</dd>
<p><hr width=50 align=left><p>
<dd>
<b>getInitials<br></b>
<spacer type=horizontal size=20><i>"ask the player for hir initials."</i><p>
<spacer type=horizontal size=20>| congratulations initials inputCharacter characters |<br>
<spacer type=horizontal size=20>initials := String fromString: '___'.<br>
<spacer type=horizontal size=20>display clearBackground.<br>
<spacer type=horizontal size=20>display bgcolor: ColorValue black.<br>
<spacer type=horizontal size=20>keyboard_handler deactivate.<br>
<spacer type=horizontal size=20>congratulations := ComposedText withText: 'Congratulations, you have acheived a high score!&lt;n&gt; Enter your initials:' expandMacros.<br>
<spacer type=horizontal size=20>congratulations centered.<br>
<spacer type=horizontal size=20>display background add: congratulations at: Asteroids windowSize x - congratulations width / 2 @ 200.<br>
<spacer type=horizontal size=20>display background add: (ComposedText withText: initials)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>at: Asteroids windowSize x - initials asComposedText width / 2 @ 250.<br>
<spacer type=horizontal size=20>[display fadeIn] fork.<br>
<spacer type=horizontal size=20>keyboard_handler flushQueue.<br>
<spacer type=horizontal size=20>characters := 0.<br>
<spacer type=horizontal size=20>[characters &lt; 3]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[[keyboard_handler queue isEmpty]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: [(Delay forMilliseconds: 50) wait].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>inputCharacter := keyboard_handler queue next keyValue.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(inputCharacter isKindOf: Character)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [(inputCharacter isAlphaNumeric or: [inputCharacter asInteger = 32])<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[characters := characters + 1.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>initials at: characters put: inputCharacter]]].<br>
<spacer type=horizontal size=20>highScores add: (HighScore score: player score initials: initials).<br>
<spacer type=horizontal size=20>highScores save.<br>
<spacer type=horizontal size=20>keyboard_handler flushQueue.<br>
<spacer type=horizontal size=20>keyboard_handler activate</dd>
<p><hr width=50 align=left><p>
<dd>
<b>play<br></b>
<spacer type=horizontal size=20><i>"start the game"</i><p>
<spacer type=horizontal size=20><br>
<spacer type=horizontal size=20>[self addPlayKeys.<br>
<spacer type=horizontal size=20>display clearBackground.<br>
<spacer type=horizontal size=20>display bgcolor: ColorValue white.<br>
<spacer type=horizontal size=20>player := Player new.<br>
<spacer type=horizontal size=20>display newGame.<br>
<spacer type=horizontal size=20>[player hasShipsRemaining]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[Processor yield.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[display centerIsClear and: [display paused not]]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>whileFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[(Delay forMilliseconds: 300) wait.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>win isOpen ifFalse: [Processor terminateActive]].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>player ship: ((Ship at: Asteroids windowBounds center)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ownedBy: player).<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>player loseShip.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>display add: player ship.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[player ship isDestroyed]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>whileFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[(Delay forSeconds: 3) wait.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>win isOpen ifFalse: [Processor terminateActive]].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>player hasShipsRemaining ifTrue: [(Delay forSeconds: 3) wait]].<br>
<spacer type=horizontal size=20>self gameOver] fork</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"initialize the game"</i><p>
<spacer type=horizontal size=20>win := (ScheduledWindow<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>model: nil<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>label: 'Asteroids'<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>minimumSize: WindowSize)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>windowType: #dialog.<br>
<spacer type=horizontal size=20>win background: ColorValue black.<br>
<spacer type=horizontal size=20>keyboard_handler := KeyboardManager for: self.<br>
<spacer type=horizontal size=20>self setUpKeyPrefs.<br>
<spacer type=horizontal size=20>self addGlobalKeys.<br>
<spacer type=horizontal size=20>player := Player new die.<br>
<spacer type=horizontal size=20>highScores := HighScoreList new.<br>
<spacer type=horizontal size=20>highScores load.<br>
<spacer type=horizontal size=20>display := DisplayManager for: self</dd>
<p><hr width=50 align=left><p>
<dd>
<b>quit<br></b>
<spacer type=horizontal size=20><i>"close the window associated with the receiver. when the processes associated with this game detect <br>
<spacer type=horizontal size=20>that the window has been closed, they will terminate"</i><p>
<spacer type=horizontal size=20>win controller closeAndUnschedule</dd>
<p><hr width=50 align=left><p>
<dd>
<b>start<br></b>
<spacer type=horizontal size=20><i>"start the program"</i><p>
<spacer type=horizontal size=20>win openIn: (Rectangle<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>left: 50<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>top: 10<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>width: WindowSize x<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>height: WindowSize y).<br>
<spacer type=horizontal size=20>display start.<br>
<spacer type=horizontal size=20>self beginDemo</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>keyboard control</b></u><p>
<dd>
<b>addGlobalKeys<br></b>
<spacer type=horizontal size=20><i>"add global key handlers to the handler dictionary."</i><br>
<spacer type=horizontal size=20><i>"global keys are valid keys during the entire duration of the program"</i><p>
<spacer type=horizontal size=20>keyboard_handler add: [display toggleFrameRateDisplay]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: #F2.<br>
<spacer type=horizontal size=20>keyboard_handler add: [display toggleLoopDelayDisplay]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: #F3.<br>
<spacer type=horizontal size=20>keyboard_handler add: [display toggleLevelDisplay]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: #F1</dd>
<p><hr width=50 align=left><p>
<dd>
<b>addPlayKeys<br></b>
<spacer type=horizontal size=20><i>"add handlers for keys used while playing a game"</i><p>
<spacer type=horizontal size=20>keyboard_handler add: [player ship thrust]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: thrustKey.<br>
<spacer type=horizontal size=20>keyboard_handler add: [player ship turnLeft]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: turnLeftKey.<br>
<spacer type=horizontal size=20>keyboard_handler add: [player ship turnRight]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: turnRightKey.<br>
<spacer type=horizontal size=20>keyboard_handler add: [player ship hyperspace]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: hyperspaceKey.<br>
<spacer type=horizontal size=20>keyboard_handler add: [player ship fire]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: fireKey.<br>
<spacer type=horizontal size=20>keyboard_handler add: [display pause]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>toHandle: $p</dd>
<p><hr width=50 align=left><p>
<dd>
<b>removeDemoKeys<br></b>
<spacer type=horizontal size=20><i>"remove the handlers for demo keys"</i><p>
<spacer type=horizontal size=20>keyboard_handler remove: Character esc.<br>
<spacer type=horizontal size=20>keyboard_handler remove: Character space.<br>
<spacer type=horizontal size=20>keyboard_handler remove: Character cr.<br>
<spacer type=horizontal size=20>keyboard_handler remove: $q</dd>
<p><hr width=50 align=left><p>
<dd>
<b>removePlayKeys<br></b>
<spacer type=horizontal size=20><i>"remove the handlers for game keys"</i><p>
<spacer type=horizontal size=20>keyboard_handler remove: thrustKey.<br>
<spacer type=horizontal size=20>keyboard_handler remove: turnLeftKey.<br>
<spacer type=horizontal size=20>keyboard_handler remove: turnRightKey.<br>
<spacer type=horizontal size=20>keyboard_handler remove: hyperspaceKey.<br>
<spacer type=horizontal size=20>keyboard_handler remove: fireKey.<br>
<spacer type=horizontal size=20>keyboard_handler remove: $p</dd>
<p><hr width=50 align=left><p>
<dd>
<b>setUpKeyPrefs<br></b>
<spacer type=horizontal size=20><i>"establish which keys perform various game functions"</i><p>
<spacer type=horizontal size=20>thrustKey := $k.<br>
<spacer type=horizontal size=20>turnLeftKey := $j.<br>
<spacer type=horizontal size=20>turnRightKey := $l.<br>
<spacer type=horizontal size=20>hyperspaceKey := Character tab.<br>
<spacer type=horizontal size=20>fireKey := Character space</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>printing</b></u><p>
<dd>
<b>printOn: aStream <br></b>
<spacer type=horizontal size=20><i>"Append to aStream a sequence of characters that describes the receiver."</i><p>
<spacer type=horizontal size=20>aStream nextPutAll: 'a game of Asteroids'</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>spriteScaleFactor<br></b>
<spacer type=horizontal size=20><i>"answers the scale factor that sprites should use to determine their size"</i><p>
<spacer type=horizontal size=20>^SpriteScaleFactor</dd>
<p><hr width=50 align=left><p>
<dd>
<b>windowBounds<br></b>
<spacer type=horizontal size=20><i>"answers a Rectangle that is the same size as the game window. This rectangle does not grow or <br>
<spacer type=horizontal size=20>shrink if the game window is resized. The game window isn't *supposed* to be resizable, but it seems <br>
<spacer type=horizontal size=20>that the NT window manager won't prevent us from making it bigger..."</i><p>
<spacer type=horizontal size=20>^WindowBounds</dd>
<p><hr width=50 align=left><p>
<dd>
<b>windowSize<br></b>
<spacer type=horizontal size=20><i>"answers a Point that describes the size of the game window. This size may not reflect the actual size <br>
<spacer type=horizontal size=20>of the window."</i><p>
<spacer type=horizontal size=20>^WindowSize</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>class initialization</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"set up class constants"</i><p>
<spacer type=horizontal size=20>WindowSize := 800 @ 600.<br>
<spacer type=horizontal size=20>WindowBounds := Rectangle origin: 0 @ 0 extent: WindowSize.<br>
<spacer type=horizontal size=20>SpriteScaleFactor := WindowBounds area / (Rectangle origin: 0 @ 0 extent: 1000 @ 700) area</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"create a new game of Asteroids."</i><p>
<spacer type=horizontal size=20>^super new initialize</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class Bullet
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Sprite
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'parent updateCount '<br>
<spacer type=horizontal size=20>classVariableNames: 'BulletShape '<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>The bullet class.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>parent &lt;Sprite&gt; the sprite that created this bullet<br>
<spacer type=horizontal size=20>updateCount &lt;Number&gt; number of times that the update method has been called on this bullet<br>
<spacer type=horizontal size=20><br>
Class Variables:<br>
<spacer type=horizontal size=20>BulletShape &lt;Polyline&gt; the shape shared by all Bullets.</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>area<br></b>
<spacer type=horizontal size=20><i>"answers the area of the bullet"</i><br>
<spacer type=horizontal size=20><i>"answers a value that is larger than the actual area, which gives bullets extra *punch* when colliding <br>
<spacer type=horizontal size=20>with other things."</i><p>
<spacer type=horizontal size=20>^100</dd>
<p><hr width=50 align=left><p>
<dd>
<b>parent<br></b>
<spacer type=horizontal size=20><i>"answers the parent of this bullet"</i><p>
<spacer type=horizontal size=20>^parent</dd>
<p><hr width=50 align=left><p>
<dd>
<b>parent: p<br></b>
<spacer type=horizontal size=20><i>"set the parent of the receiver"</i><p>
<spacer type=horizontal size=20>parent := p</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"initialize the receiver"</i><p>
<spacer type=horizontal size=20>super initialize.<br>
<spacer type=horizontal size=20>shape := BulletShape.<br>
<spacer type=horizontal size=20>updateCount := 0</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>testing</b></u><p>
<dd>
<b>isCollidingWith: aSprite <br></b>
<spacer type=horizontal size=20><i>"answers true if the receiver is colliding with aSprite"</i><p>
<spacer type=horizontal size=20>| isHit |<br>
<spacer type=horizontal size=20>self isVisible ifFalse: [^false].<br>
<spacer type=horizontal size=20>(aSprite isMemberOf: Bullet)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [aSprite parent = parent ifTrue: [^false]].<br>
<spacer type=horizontal size=20>(aSprite isMemberOf: FlamingBit)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^false].<br>
<spacer type=horizontal size=20>aSprite = parent ifTrue: [^false].<br>
<spacer type=horizontal size=20>isHit := (LineSegment from: location to: location - velocity)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>outlineIntersects: aSprite collisionCheckRectangle.<br>
<spacer type=horizontal size=20>isHit ifTrue: [(parent isKindOf: Ship)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [parent player award: aSprite pointValue]].<br>
<spacer type=horizontal size=20>^isHit</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>transforming</b></u><p>
<dd>
<b>addFlamingBits<br></b>
<spacer type=horizontal size=20><i>"bullets don't leave anything around after they explode"</i><p>
<spacer type=horizontal size=20>^nil</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>updating</b></u><p>
<dd>
<b>update<br></b>
<spacer type=horizontal size=20><i>"update the receiver's location, etc. if the receiver has been updated enough times, it is removed <br>
<spacer type=horizontal size=20>from the world"</i><p>
<spacer type=horizontal size=20>super update.<br>
<spacer type=horizontal size=20>updateCount := updateCount + 1.<br>
<spacer type=horizontal size=20>updateCount &gt; 11 ifTrue: [self destroy]</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>class initialization</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"set up bullet shape constant"</i><p>
<spacer type=horizontal size=20>BulletShape := Polyline vertices: (Array<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>with: 0 @ 0<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>with: 0 @ 1<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>with: 1 @ 0<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>with: 1 @ 1)</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>fromSpaceship: myCreator <br></b>
<spacer type=horizontal size=20><i>"answers a new bullet, owned by myCreator."</i><br>
<spacer type=horizontal size=20><i>"Sometimes, depending on the player's level, the bullet will be aimed directly at the player. Otherwise, <br>
<spacer type=horizontal size=20>the direction is random."</i><p>
<spacer type=horizontal size=20>| missile playerShip |<br>
<spacer type=horizontal size=20>missile := super new initialize.<br>
<spacer type=horizontal size=20>missile parent: myCreator.<br>
<spacer type=horizontal size=20>missile moveTo: myCreator location + myCreator velocity.<br>
<spacer type=horizontal size=20>missile velocity: (Point r: 35 * Asteroids spriteScaleFactor theta: (RandomNumber between: 0.0 and: 2 * 3.14159))<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>+ myCreator velocity.<br>
<spacer type=horizontal size=20>myCreator world do: [:s | (s isMemberOf: Ship)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [playerShip := s]].<br>
<spacer type=horizontal size=20>Object messageNotUnderstoodSignal handle: [:ex | ex return]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>do: [(RandomNumber chance: playerShip player level * 4)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [missile velocity: (Point r: missile velocity r theta: (playerShip location - missile location) theta)]].<br>
<spacer type=horizontal size=20>^missile</dd>
<p><hr width=50 align=left><p>
<dd>
<b>parent: myCreator <br></b>
<spacer type=horizontal size=20><i>"answers a new bullet, owned by myCreator."</i><p>
<spacer type=horizontal size=20>| missile |<br>
<spacer type=horizontal size=20>(myCreator isKindOf: Spaceship)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^self fromSpaceship: myCreator].<br>
<spacer type=horizontal size=20>missile := super new initialize.<br>
<spacer type=horizontal size=20>missile parent: myCreator.<br>
<spacer type=horizontal size=20>missile velocity: (Point r: 35 * Asteroids spriteScaleFactor theta: myCreator direction)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>+ myCreator velocity.<br>
<spacer type=horizontal size=20>missile moveTo: (Point r: Ship radius + 10 theta: myCreator direction)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>+ myCreator location + myCreator velocity.<br>
<spacer type=horizontal size=20>^missile</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class DisplayManager
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'world gameState background bgcolor gc paused asteroidSpitter shipSpitter showFrameRate showLoopDelay showLevel '<br>
<spacer type=horizontal size=20>classVariableNames: 'LittleShip UpdatePeriod '<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>A DisplayManager handles updating sprites and redrawing the screen.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>world &lt;SpriteWorld&gt; the set of sprites that this scheduler controls<br>
<spacer type=horizontal size=20>gameState &lt;Asteroids&gt; the game whose display this manager is controlling<br>
<spacer type=horizontal size=20>background &lt;CompositePart&gt; the component that holds static background elements<br>
<spacer type=horizontal size=20>bgcolor &lt;ColorValue&gt; the color with which the background component is drawn<br>
<spacer type=horizontal size=20>gc &lt;GraphicsContext&gt; the graphics context of the window this manager controlls<br>
<spacer type=horizontal size=20>paused &lt;Boolean&gt; true when the game is paused<br>
<spacer type=horizontal size=20>asteroidSpitter &lt;Process&gt; the process that creates new asteroids<br>
<spacer type=horizontal size=20>shipSpitter &lt;Process&gt; the process that creates spaceships<br>
<spacer type=horizontal size=20>showFrameRate &lt;Boolean&gt; if true, the frame rate is displayed on the screen<br>
<spacer type=horizontal size=20>showLoopDelay &lt;Boolean&gt; if true, the update loop delay is displayed on the screen<br>
<spacer type=horizontal size=20>showLevel &lt;Boolean&gt; if true, the player level is displayed on the screen<p>
Class Variables:<br>
<spacer type=horizontal size=20>LittleShip &lt;Polyline&gt; the shape drawn to represent a ship that the player has in reserve<br>
<spacer type=horizontal size=20>UpdatePeriod &lt;Number&gt; the (minimum) period between updates</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>add: aSprite <br></b>
<spacer type=horizontal size=20><i>"add aSprite to the world"</i><p>
<spacer type=horizontal size=20>world add: aSprite</dd>
<p><hr width=50 align=left><p>
<dd>
<b>addMoreAsteroids<br></b>
<spacer type=horizontal size=20><i>"add asteroids to the playing field."</i><p>
<spacer type=horizontal size=20>| numberOfAsteroids |<br>
<spacer type=horizontal size=20>gameState player notNil<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [numberOfAsteroids := 3 + (gameState player level // 2) min: 8]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [numberOfAsteroids := 5].<br>
<spacer type=horizontal size=20>1 to: numberOfAsteroids do: [:i | world add: Asteroid new]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>background<br></b>
<spacer type=horizontal size=20><i>"answer the compositePart that holds the background objects."</i><p>
<spacer type=horizontal size=20>^background</dd>
<p><hr width=50 align=left><p>
<dd>
<b>background: aCompositePart<br></b>
<spacer type=horizontal size=20><i>"set the compositePart that holds the background objects."</i><p>
<spacer type=horizontal size=20>background := aCompositePart</dd>
<p><hr width=50 align=left><p>
<dd>
<b>bgcolor<br></b>
<spacer type=horizontal size=20><i>"answers the receiver's background color (the color in which the background component is drawn)"</i><p>
<spacer type=horizontal size=20>^bgcolor</dd>
<p><hr width=50 align=left><p>
<dd>
<b>bgcolor: c <br></b>
<spacer type=horizontal size=20><i>"set the background color"</i><p>
<spacer type=horizontal size=20>bgcolor := c</dd>
<p><hr width=50 align=left><p>
<dd>
<b>game: aGame <br></b>
<spacer type=horizontal size=20><i>"set the game for which the receiver is to manage the display"</i><p>
<spacer type=horizontal size=20>gameState := aGame</dd>
<p><hr width=50 align=left><p>
<dd>
<b>paused<br></b>
<spacer type=horizontal size=20><i>"answers true if the game is paused"</i><p>
<spacer type=horizontal size=20>^paused</dd>
<p><hr width=50 align=left><p>
<dd>
<b>removeAllSprites<br></b>
<spacer type=horizontal size=20><i>"remove all sprites from the playing field"</i><p>
<spacer type=horizontal size=20>world destroyAll</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>control</b></u><p>
<dd>
<b>clearBackground<br></b>
<spacer type=horizontal size=20><i>"remove all objects from the background."</i><p>
<spacer type=horizontal size=20>background := CompositePart new</dd>
<p><hr width=50 align=left><p>
<dd>
<b>fadeIn<br></b>
<spacer type=horizontal size=20><i>"fade the background color to white"</i><p>
<spacer type=horizontal size=20>bgcolor brightness<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>to: 1<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>by: 0.3<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[:c | <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>bgcolor := ColorValue brightness: c. <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(Delay forMilliseconds: UpdatePeriod) wait]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>fadeOut<br></b>
<spacer type=horizontal size=20><i>"fade the background color to black"</i><p>
<spacer type=horizontal size=20>bgcolor brightness<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>to: 0<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>by: -0.3<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[:c | <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>bgcolor := ColorValue brightness: c.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(Delay forMilliseconds: UpdatePeriod) wait]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>newGame<br></b>
<spacer type=horizontal size=20><i>"initialize the display for a new game"</i><p>
<spacer type=horizontal size=20>shipSpitter terminate.<br>
<spacer type=horizontal size=20>asteroidSpitter terminate.<br>
<spacer type=horizontal size=20>self removeAllSprites.<br>
<spacer type=horizontal size=20>asteroidSpitter := [self asteroidSpitter] fork.<br>
<spacer type=horizontal size=20>shipSpitter := [self shipSpitter] fork</dd>
<p><hr width=50 align=left><p>
<dd>
<b>pause<br></b>
<spacer type=horizontal size=20><i>"pause the game"</i><p>
<spacer type=horizontal size=20>paused := true.<br>
<spacer type=horizontal size=20>shipSpitter suspend</dd>
<p><hr width=50 align=left><p>
<dd>
<b>start<br></b>
<spacer type=horizontal size=20><i>"start managing the display"</i><p>
<spacer type=horizontal size=20>[self updateLoop] fork.<br>
<spacer type=horizontal size=20>asteroidSpitter := [self asteroidSpitter] fork.<br>
<spacer type=horizontal size=20>shipSpitter := [self shipSpitter] fork</dd>
<p><hr width=50 align=left><p>
<dd>
<b>toggleFrameRateDisplay<br></b>
<spacer type=horizontal size=20><i>"toggle the state of displaying the frame rate on the screen"</i><p>
<spacer type=horizontal size=20>showFrameRate := showFrameRate not</dd>
<p><hr width=50 align=left><p>
<dd>
<b>toggleLevelDisplay<br></b>
<spacer type=horizontal size=20><i>"toggle the state of displaying the player's level on the screen"</i><p>
<spacer type=horizontal size=20>showLevel := showLevel not</dd>
<p><hr width=50 align=left><p>
<dd>
<b>toggleLoopDelayDisplay<br></b>
<spacer type=horizontal size=20><i>"toggle the state of displaying the update loop delay on the screen"</i><p>
<spacer type=horizontal size=20>showLoopDelay := showLoopDelay not</dd>
<p><hr width=50 align=left><p>
<dd>
<b>unpause<br></b>
<spacer type=horizontal size=20><i>"take the game out of pause mode"</i><p>
<spacer type=horizontal size=20>paused ifTrue: [shipSpitter resume].<br>
<spacer type=horizontal size=20>paused := false</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"initialize the receiver"</i><p>
<spacer type=horizontal size=20>world := SpriteWorld new.<br>
<spacer type=horizontal size=20>background := CompositePart new.<br>
<spacer type=horizontal size=20>bgcolor := ColorValue white.<br>
<spacer type=horizontal size=20>paused := false.<br>
<spacer type=horizontal size=20>showLoopDelay := false.<br>
<spacer type=horizontal size=20>showFrameRate := false.<br>
<spacer type=horizontal size=20>showLevel := true</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>private</b></u><p>
<dd>
<b>displayDelayBar: loopDelay <br></b>
<spacer type=horizontal size=20><i>"draw the update loop delay bar on the graphics buffer"</i><p>
<spacer type=horizontal size=20>| colorBar |<br>
<spacer type=horizontal size=20>colorBar := Rectangle origin: Asteroids windowSize - (50 @ 20) extent: 40 @ 20.<br>
<spacer type=horizontal size=20>gc paint: (ColorValue<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>red: (loopDelay &gt; (UpdatePeriod + 10)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [0.75]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [0])<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>green: (loopDelay &lt;= (UpdatePeriod + 20)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [0.75]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [0])<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>blue: 0).<br>
<spacer type=horizontal size=20>colorBar displayFilledOn: gc.<br>
<spacer type=horizontal size=20>gc paint: ColorValue black.<br>
<spacer type=horizontal size=20>(loopDelay printStringRadix: 10) asComposedText displayOn: gc at: Asteroids windowSize - (40 @ 20)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayFrameRate: loopDelay <br></b>
<spacer type=horizontal size=20><i>"draw the screen refresh rate on the graphics buffer"</i><p>
<spacer type=horizontal size=20>| aStream rate |<br>
<spacer type=horizontal size=20>gc paint: ColorValue gray.<br>
<spacer type=horizontal size=20>aStream := WriteStream on: (String new: 6).<br>
<spacer type=horizontal size=20>(1000 / loopDelay asFixedPoint: 1)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>printOn: aStream.<br>
<spacer type=horizontal size=20>rate := aStream contents asComposedText centered.<br>
<spacer type=horizontal size=20>rate displayOn: gc at: Asteroids windowSize x - rate width // 2 @ (Asteroids windowSize y - 20)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayLevel<br></b>
<spacer type=horizontal size=20><i>"draw the player's level on the graphics buffer"</i><p>
<spacer type=horizontal size=20>gc paint: ColorValue white.<br>
<spacer type=horizontal size=20>('Level: ' , (gameState player level printStringRadix: 10)) asComposedText displayOn: gc at: 20 @ (Asteroids windowSize y - 20)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayScore<br></b>
<spacer type=horizontal size=20><i>"draw the score on the graphics buffer"</i><p>
<spacer type=horizontal size=20>gc paint: ColorValue white.<br>
<spacer type=horizontal size=20>(gameState player score printStringRadix: 10) asComposedText displayOn: gc at: 80 @ 20</dd>
<p><hr width=50 align=left><p>
<dd>
<b>displayShipsRemaining<br></b>
<spacer type=horizontal size=20><i>"draw the number of ships remaining on the graphics buffer"</i><p>
<spacer type=horizontal size=20>gc paint: ColorValue white.<br>
<spacer type=horizontal size=20>1 to: gameState player ships do: [:i | (LittleShip translatedBy: 65 + (20 * i) @ 60)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>displayStrokedOn: gc]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>processes</b></u><p>
<dd>
<b>asteroidSpitter<br></b>
<spacer type=horizontal size=20><i>"spawns asteroids when there's no more left"</i><p>
<spacer type=horizontal size=20>[gameState window isOpen]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[self addMoreAsteroids.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[self asteroidsExist]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[Processor yield.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(Delay forSeconds: 2) wait.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>gameState window isOpen ifFalse: [Processor terminateActive]].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(Delay forSeconds: 2) wait.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>gameState player isAlive ifTrue: [gameState player gainLevel]]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>shipSpitter<br></b>
<spacer type=horizontal size=20><i>"spawns spaceships"</i><p>
<spacer type=horizontal size=20>[gameState window isOpen]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[(Delay forSeconds: (20 - (gameState player level // 3) max: 15)) wait.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>gameState window isOpen ifFalse: [Processor terminateActive].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>gameState player level &gt; 1 ifTrue: [gameState player level &gt; 5<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [world add: Spaceship small]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [world add: Spaceship large]]]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>updateLoop<br></b>
<spacer type=horizontal size=20><i>"polls the keyboard, updates the sprites in the world, and displays the next frame in the window"</i><p>
<spacer type=horizontal size=20>| windowGC buffer startTime loopDelay untilTimeToRefresh |<br>
<spacer type=horizontal size=20>windowGC := gameState window graphicsContext.<br>
<spacer type=horizontal size=20>buffer := Pixmap extent: Asteroids windowSize.<br>
<spacer type=horizontal size=20>gc := buffer graphicsContext.<br>
<spacer type=horizontal size=20>buffer background: ColorValue black.<br>
<spacer type=horizontal size=20>loopDelay := 1.<br>
<spacer type=horizontal size=20>Object errorSignal handle: [:ex | gameState window isOpen<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [ex reject]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [ex return]]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>do: [[gameState window isOpen]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[startTime := Time millisecondClockValue.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>untilTimeToRefresh := Delay untilMilliseconds: startTime + UpdatePeriod.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>gc clear.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>gameState keyboard_handler pollKeyboard.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>Processor yield.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self paused ifFalse: [world update].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>world displayOn: gc.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>gc paint: bgcolor.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>background displayOn: gc.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self displayShipsRemaining.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self displayScore.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>showLevel ifTrue: [self displayLevel].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>showLoopDelay ifTrue: [self displayDelayBar: loopDelay].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>showFrameRate ifTrue: [self displayFrameRate: loopDelay].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>buffer displayOn: windowGC.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>loopDelay := Time millisecondClockValue - startTime.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>untilTimeToRefresh wait]]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>testing</b></u><p>
<dd>
<b>asteroidsExist<br></b>
<spacer type=horizontal size=20><i>"answers true if there are still asteroids on the screen"</i><p>
<spacer type=horizontal size=20>| retblock |<br>
<spacer type=horizontal size=20>retblock := [^true].<br>
<spacer type=horizontal size=20>world do: [:s | (s isMemberOf: Asteroid)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [retblock value]].<br>
<spacer type=horizontal size=20>^false</dd>
<p><hr width=50 align=left><p>
<dd>
<b>centerIsClear<br></b>
<spacer type=horizontal size=20><i>"answers true if the center is clear to add a ship."</i><p>
<spacer type=horizontal size=20>^((Ship at: Asteroids windowBounds center)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>world: world) isClear</dd>
<p><hr width=50 align=left><p>
<dd>
<b>spriteExists: aSprite <br></b>
<spacer type=horizontal size=20><i>"answers true if aSprite exists on the screen"</i><p>
<spacer type=horizontal size=20>| retblock |<br>
<spacer type=horizontal size=20>retblock := [^true].<br>
<spacer type=horizontal size=20>world do: [:s | s sprite = aSprite ifTrue: [retblock value]].<br>
<spacer type=horizontal size=20>^false</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>class initialization</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"set up class variables (constants)"</i><p>
<spacer type=horizontal size=20>Ship initialize.<br>
<spacer type=horizontal size=20>LittleShip := Ship new shape scaledBy: 1 / 3.<br>
<spacer type=horizontal size=20>UpdatePeriod := 80</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>for: aGame <br></b>
<spacer type=horizontal size=20><i>"answers a new DisplayManager to handle the display for aGame."</i><p>
<spacer type=horizontal size=20>| engine |<br>
<spacer type=horizontal size=20>engine := super new.<br>
<spacer type=horizontal size=20>engine game: aGame.<br>
<spacer type=horizontal size=20>engine initialize.<br>
<spacer type=horizontal size=20>^engine</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class FlamingBit
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Sprite
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: ''<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>A FlamingBit is a piece of a sprite that remains after it explodes.<br>
</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>collision detection</b></u><p>
<dd>
<b>checkForCollision<br></b>
<spacer type=horizontal size=20><i>"FlamingBits don't collide with anything"</i><p>
<spacer type=horizontal size=20>^nil</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isCollidingWith: aSprite <br></b>
<spacer type=horizontal size=20><i>"answers true if the receiver is colliding with aSprite"</i><p>
<spacer type=horizontal size=20>^false</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>transforming</b></u><p>
<dd>
<b>addFlamingBits<br></b>
<spacer type=horizontal size=20><i>"FlamingBits don't explode into other FlamingBits"</i><p>
<spacer type=horizontal size=20>^nil</dd>
<p><hr width=50 align=left><p>
<dd>
<b>rotate: angle <br></b>
<spacer type=horizontal size=20><i>"rotate the flaming bit by an angle (in radians)"</i><p>
<spacer type=horizontal size=20>angle isZero ifFalse: [shape := LineSegment from: (Point r: shape end r theta: shape end theta + angle)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>to: (Point r: shape start r theta: shape start theta + angle)]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>updating</b></u><p>
<dd>
<b>update<br></b>
<spacer type=horizontal size=20><i>"move the receiver to its new location, darken its color, and if it's black, destroy it."</i><p>
<spacer type=horizontal size=20>super update.<br>
<spacer type=horizontal size=20>color := ColorValue brightness: (color brightness - (RandomNumber lessThan: 0.15) max: 0).<br>
<spacer type=horizontal size=20>color brightness = 0 ifTrue: [self destroy]</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>from: startPoint to: endPoint at: aPoint velocity: v <br></b>
<spacer type=horizontal size=20><i>"answers a new flaming bit."</i><p>
<spacer type=horizontal size=20>| bit midpoint |<br>
<spacer type=horizontal size=20>bit := super new initialize.<br>
<spacer type=horizontal size=20>midpoint := startPoint x + endPoint x // 2 @ (startPoint y + endPoint y // 2).<br>
<spacer type=horizontal size=20>bit shape: ((LineSegment from: startPoint - midpoint to: endPoint - midpoint)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>scaledBy: (RandomNumber between: 0.7 and: 1)).<br>
<spacer type=horizontal size=20>bit moveTo: aPoint + midpoint.<br>
<spacer type=horizontal size=20>bit velocity: v + (RandomNumber between: -16 @ -16 and: 16 @ 16).<br>
<spacer type=horizontal size=20>bit angular_speed: (RandomNumber between: bit velocity r / 20 negated and: bit velocity r / 20).<br>
<spacer type=horizontal size=20>^bit</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class HighScore
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'score initials '<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>Instances of HighScore represent a high score and the initials of the player that scored it.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>score &lt;Number&gt; the score<br>
<spacer type=horizontal size=20>initials &lt;String&gt; the initials</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>initials<br></b>
<spacer type=horizontal size=20><i>"answer the initials"</i><p>
<spacer type=horizontal size=20>^initials</dd>
<p><hr width=50 align=left><p>
<dd>
<b>initials: i <br></b>
<spacer type=horizontal size=20><i>"sets the receiver's initials"</i><p>
<spacer type=horizontal size=20>initials := i</dd>
<p><hr width=50 align=left><p>
<dd>
<b>score<br></b>
<spacer type=horizontal size=20><i>"answers the score"</i><p>
<spacer type=horizontal size=20>^score</dd>
<p><hr width=50 align=left><p>
<dd>
<b>score: s <br></b>
<spacer type=horizontal size=20><i>"sets the receiver's score"</i><p>
<spacer type=horizontal size=20>score := s</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>comparing</b></u><p>
<dd>
<b>&lt; aHighScore <br></b>
<spacer type=horizontal size=20><i>"Answer whether the receiver is less than the argument."</i><p>
<spacer type=horizontal size=20>^self score &lt; aHighScore score</dd>
<p><hr width=50 align=left><p>
<dd>
<b>&gt; aHighScore <br></b>
<spacer type=horizontal size=20><i>"Answer whether the receiver is greater than the argument."</i><p>
<spacer type=horizontal size=20>^self score &gt; aHighScore score</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>converting</b></u><p>
<dd>
<b>asString<br></b>
<spacer type=horizontal size=20>^(initials , '&lt;t&gt;&lt;t&gt;' , (score printStringRadix: 10)) expandMacros</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20>score := 0.<br>
<spacer type=horizontal size=20>initials := String fromString: '...'</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>printing</b></u><p>
<dd>
<b>printOn: aStream <br></b>
<spacer type=horizontal size=20><i>"Append to aStream a sequence of characters that describes the receiver."</i><p>
<spacer type=horizontal size=20>score printOn: aStream.<br>
<spacer type=horizontal size=20>aStream nextPutAll: ' : '.<br>
<spacer type=horizontal size=20>initials printOn: aStream</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"answers a new high score"</i><p>
<spacer type=horizontal size=20>^super new initialize</dd>
<p><hr width=50 align=left><p>
<dd>
<b>score: s initials: i <br></b>
<spacer type=horizontal size=20><i>"answers a new high score with the fields set according to the arguments"</i><p>
<spacer type=horizontal size=20>| newHighScore |<br>
<spacer type=horizontal size=20>newHighScore := super new.<br>
<spacer type=horizontal size=20>newHighScore score: s.<br>
<spacer type=horizontal size=20>newHighScore initials: i.<br>
<spacer type=horizontal size=20>^newHighScore</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class HighScoreList
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'list '<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>Instances of HighScoreList hold a list of high scores that can be loaded from and saved to a file.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>list &lt;SortedCollection&gt; a collection of HighScores</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>adding</b></u><p>
<dd>
<b>add: highScore <br></b>
<spacer type=horizontal size=20><i>"add a new high score to the list. The size of the list won't go above 10."</i><p>
<spacer type=horizontal size=20>list add: highScore.<br>
<spacer type=horizontal size=20>[list size &gt; 10]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: [list removeLast]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>converting</b></u><p>
<dd>
<b>asComposedText<br></b>
<spacer type=horizontal size=20><i>"answers a ComposedText representation of the list"</i><p>
<spacer type=horizontal size=20>| text |<br>
<spacer type=horizontal size=20>text := ComposedText withText: self asString.<br>
<spacer type=horizontal size=20>text rightFlush.<br>
<spacer type=horizontal size=20>^text</dd>
<p><hr width=50 align=left><p>
<dd>
<b>asString<br></b>
<spacer type=horizontal size=20><i>"answers a String representation of the list"</i><p>
<spacer type=horizontal size=20>| text |<br>
<spacer type=horizontal size=20>text := ''.<br>
<spacer type=horizontal size=20>list do: [:i | text := text , i asString]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>separatedBy: [text := text , '&lt;n&gt;' expandMacros].<br>
<spacer type=horizontal size=20>^text</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>file I/O</b></u><p>
<dd>
<b>load<br></b>
<spacer type=horizontal size=20><i>"load high scores from a disk file"</i><p>
<spacer type=horizontal size=20>| boss |<br>
<spacer type=horizontal size=20>Signal noHandlerSignal handle: [:ex | ex return]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[boss := BinaryObjectStorage onOldNoScan: (FileConnection<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>openFileNamed: 'Asteroids high scores'<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>mode: #readOnly<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>creationRule: #noCreate) input readStream.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[list := boss next]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>valueNowOrOnUnwindDo: [boss close]]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>save<br></b>
<spacer type=horizontal size=20><i>"save high scores to a disk file"</i><p>
<spacer type=horizontal size=20>| boss |<br>
<spacer type=horizontal size=20>Signal noHandlerSignal handle: [:ex | ex return]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[boss := BinaryObjectStorage onNew: (FileConnection<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>openFileNamed: 'Asteroids high scores'<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>mode: #writeOnly<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>creationRule: #truncateOrCreate) output writeStream.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[boss nextPut: list]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>valueNowOrOnUnwindDo: [boss close]]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20>list := SortedCollection sortBlock: [:x :y | x &gt; y].<br>
<spacer type=horizontal size=20>1 to: 10 do: [:i | list add: HighScore new]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>printing</b></u><p>
<dd>
<b>printOn: aStream <br></b>
<spacer type=horizontal size=20><i>"Append to aStream a sequence of characters that describes the receiver."</i><p>
<spacer type=horizontal size=20>list printOn: aStream</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>testing</b></u><p>
<dd>
<b>isHighScore: score <br></b>
<spacer type=horizontal size=20><i>"answers true if score is a high score"</i><p>
<spacer type=horizontal size=20>^score &gt; list last score</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"answers a new high score list"</i><p>
<spacer type=horizontal size=20>^super new initialize</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class KeyboardManager
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'game queue handlerDictionary active '<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>Instances of KeyboardManager perform actions when keyboard events occur.<p>
Instance variables:<br>
<spacer type=horizontal size=20>game &lt;Asteroids&gt; the game this manager controls input for<br>
<spacer type=horizontal size=20>queue &lt;SharedQueue&gt; the keyboard event queue associated with the game window<br>
<spacer type=horizontal size=20>handlerDictionary &lt;Dictionary&gt; a dictionary consisting of character, block pairs. <br>
<spacer type=horizontal size=20>active &lt;Boolean&gt; true if the manager should poll the keyboard and dispatch actions</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>activate<br></b>
<spacer type=horizontal size=20><i>"make the receiver active; that is, poll the keyboard and dispatch actions"</i><p>
<spacer type=horizontal size=20>active := true</dd>
<p><hr width=50 align=left><p>
<dd>
<b>deactivate<br></b>
<spacer type=horizontal size=20><i>"make the receiver inactive; that is, don't poll the keyboard or dispatch actions"</i><p>
<spacer type=horizontal size=20>active := false</dd>
<p><hr width=50 align=left><p>
<dd>
<b>game: aGame <br></b>
<spacer type=horizontal size=20><i>"set the game for which the receiver is to handle input for"</i><p>
<spacer type=horizontal size=20>game := aGame</dd>
<p><hr width=50 align=left><p>
<dd>
<b>queue<br></b>
<spacer type=horizontal size=20><i>"answers the receiver's keyboard event queue"</i><p>
<spacer type=horizontal size=20>^queue</dd>
<p><hr width=50 align=left><p>
<dd>
<b>queue: aKeyboardDevice <br></b>
<spacer type=horizontal size=20><i>"set the receiver's keyboard event queue"</i><p>
<spacer type=horizontal size=20>queue := aKeyboardDevice</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>handlers</b></u><p>
<dd>
<b>add: aBlock toHandle: aCharacter <br></b>
<spacer type=horizontal size=20><i>"add a keypress handler routine to the handler dictionary"</i><p>
<spacer type=horizontal size=20>handlerDictionary add: (Association key: aCharacter value: aBlock)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>remove: aCharacter <br></b>
<spacer type=horizontal size=20><i>"remove the handler for aCharacter from the handler dictionary"</i><p>
<spacer type=horizontal size=20>handlerDictionary add: (Association key: aCharacter value: [])</dd>
<p><hr width=50 align=left><p>
<dd>
<b>removeAll<br></b>
<spacer type=horizontal size=20><i>"remove all handlers from the dictionary"</i><p>
<spacer type=horizontal size=20>handlerDictionary := Dictionary new.</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>flushQueue<br></b>
<spacer type=horizontal size=20>[queue isEmpty] whileFalse: [queue next]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20>handlerDictionary := Dictionary new.<br>
<spacer type=horizontal size=20>self flushQueue.<br>
<spacer type=horizontal size=20>active := true</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>polling</b></u><p>
<dd>
<b>pollKeyboard<br></b>
<spacer type=horizontal size=20><i>"poll the keyboard, dispatch events as required"</i><p>
<spacer type=horizontal size=20>| inputCharacter handler |<br>
<spacer type=horizontal size=20>active ifTrue: [queue isEmpty<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[inputCharacter := queue next keyValue.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>game display paused<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [game display unpause]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[handler := handlerDictionary at: inputCharacter ifAbsent: [nil].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>handler isNil ifFalse: [handler value]]]]</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>for: aGame<br></b>
<spacer type=horizontal size=20><i>"answers a new handler to handle keyboard events for an asteroids game"</i><p>
<spacer type=horizontal size=20>| handler |<br>
<spacer type=horizontal size=20>handler := super new.<br>
<spacer type=horizontal size=20>handler game: aGame.<br>
<spacer type=horizontal size=20>handler queue: aGame window sensor keyboardDevice.<br>
<spacer type=horizontal size=20>handler initialize.<br>
<spacer type=horizontal size=20>^handler</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class MyLinkedList
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
LinkedList
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: ''<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>This is the basic LinkedList class with a method added to efficiently remove large numbers of elements all at once.</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>removing</b></u><p>
<dd>
<b>removeIf: aBlock <br></b>
<spacer type=horizontal size=20><i>"iterate over each link in the list, passing aBlock the link. If aBlock evaluates to true, remove that <br>
<spacer type=horizontal size=20>link."</i><p>
<spacer type=horizontal size=20>| previousLink |<br>
<spacer type=horizontal size=20>[firstLink ~~ nil and: [aBlock value: firstLink]]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>whileTrue: [self removeFirst].<br>
<spacer type=horizontal size=20>firstLink ~~ nil<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[previousLink := firstLink.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[previousLink nextLink == nil]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>whileFalse: [(aBlock value: previousLink nextLink)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[previousLink nextLink == lastLink ifTrue: [lastLink := previousLink].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>previousLink nextLink: previousLink nextLink nextLink]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [previousLink := previousLink nextLink]]]</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<i>(none)</i><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class Player
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'score ships level ship '<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>A Player holds the information about a person who is playing Asteroids.<p>
Instance variables:<br>
<spacer type=horizontal size=20>score &lt;Number&gt; Player's score.<br>
<spacer type=horizontal size=20>ships &lt;Number&gt; Number of ships remaining.<br>
<spacer type=horizontal size=20>level &lt;Number&gt; Level we're playing on.<br>
<spacer type=horizontal size=20>ship &lt;Number&gt; The Ship associated with the player</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>award: points <br></b>
<spacer type=horizontal size=20><i>"add points to the receiver's score"</i><br>
<spacer type=horizontal size=20><i>"award the player a new ship every 10000 points"</i><p>
<spacer type=horizontal size=20>score + points \\ 10000 &lt; (score \\ 10000) ifTrue: [self gainShip].<br>
<spacer type=horizontal size=20>score := score + points</dd>
<p><hr width=50 align=left><p>
<dd>
<b>die<br></b>
<spacer type=horizontal size=20><i>"kill off the receiver"</i><p>
<spacer type=horizontal size=20>ships := -1.<br>
<spacer type=horizontal size=20>ship notNil ifTrue: [ship destroy]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>gainLevel<br></b>
<spacer type=horizontal size=20><i>"move the receiver up a level"</i><p>
<spacer type=horizontal size=20>level := level + 1</dd>
<p><hr width=50 align=left><p>
<dd>
<b>gainShip<br></b>
<spacer type=horizontal size=20><i>"receiver gains a ship"</i><p>
<spacer type=horizontal size=20>ships := ships + 1</dd>
<p><hr width=50 align=left><p>
<dd>
<b>level<br></b>
<spacer type=horizontal size=20><i>"answers the level at which this player is currently playing at."</i><p>
<spacer type=horizontal size=20>^level</dd>
<p><hr width=50 align=left><p>
<dd>
<b>level: l <br></b>
<spacer type=horizontal size=20><i>"set the level of the receiver"</i><p>
<spacer type=horizontal size=20>level := l</dd>
<p><hr width=50 align=left><p>
<dd>
<b>loseShip<br></b>
<spacer type=horizontal size=20><i>"receiver loses a ship"</i><p>
<spacer type=horizontal size=20>ships := ships - 1</dd>
<p><hr width=50 align=left><p>
<dd>
<b>score<br></b>
<spacer type=horizontal size=20><i>"answers the player's score"</i><p>
<spacer type=horizontal size=20>^score</dd>
<p><hr width=50 align=left><p>
<dd>
<b>score: s <br></b>
<spacer type=horizontal size=20><i>"set the receiver's score"</i><p>
<spacer type=horizontal size=20>score := s</dd>
<p><hr width=50 align=left><p>
<dd>
<b>ship<br></b>
<spacer type=horizontal size=20><i>"answers the Ship sprite associated with this player"</i><p>
<spacer type=horizontal size=20>^ship</dd>
<p><hr width=50 align=left><p>
<dd>
<b>ship: aShip <br></b>
<spacer type=horizontal size=20><i>"set aShip to be the player's ship."</i><p>
<spacer type=horizontal size=20>ship := aShip</dd>
<p><hr width=50 align=left><p>
<dd>
<b>ships<br></b>
<spacer type=horizontal size=20><i>"answers the number of ships remaining"</i><p>
<spacer type=horizontal size=20>^ships max: 0</dd>
<p><hr width=50 align=left><p>
<dd>
<b>ships: numberOfShips <br></b>
<spacer type=horizontal size=20><i>"set the number of ships remaining"</i><p>
<spacer type=horizontal size=20>ships := numberOfShips</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"initialize the object"</i><p>
<spacer type=horizontal size=20>score := 0.<br>
<spacer type=horizontal size=20>ships := 3.<br>
<spacer type=horizontal size=20>level := 1.<br>
<spacer type=horizontal size=20>ship := nil</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>testing</b></u><p>
<dd>
<b>hasShipsRemaining<br></b>
<spacer type=horizontal size=20><i>"answers true if the player still has ships left."</i><p>
<spacer type=horizontal size=20>^ships &gt; 0</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isAlive<br></b>
<spacer type=horizontal size=20><i>"answers true if the player is still alive."</i><p>
<spacer type=horizontal size=20>^ships &gt; -1</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"answers a new player"</i><p>
<spacer type=horizontal size=20>^super new initialize</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class RandomNumber
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Random
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: ''<br>
<spacer type=horizontal size=20>classVariableNames: 'R '<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>Don't make instances of this class.  Use the class methods for access.<p>
Class Variables:<br>
<spacer type=horizontal size=20>R &lt;Random&gt; Random number generator.</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<i>(none)</i><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>between: left and: right <br></b>
<spacer type=horizontal size=20><i>"returns a value between left and right, inclusive"</i><p>
<spacer type=horizontal size=20>| retval |<br>
<spacer type=horizontal size=20>(left isKindOf: Point)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^self pointBetween: left and: right].<br>
<spacer type=horizontal size=20>right &gt;= left<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[retval := R next * (right - left) + left.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>((left isKindOf: Integer)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>and: [right isKindOf: Integer])<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [retval := retval rounded].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>^retval]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [^self between: right and: left]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>chance: probability <br></b>
<spacer type=horizontal size=20><i>"answers true if a random event of given probability occurs. <br>
<spacer type=horizontal size=20>The probability is given as an integer between 0 and 100 or as a percentage between 0 and 1."</i><p>
<spacer type=horizontal size=20>(probability isKindOf: Integer)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^R next &lt; (probability / 100)]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [^R next &lt; probability]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>lessThan: limit <br></b>
<spacer type=horizontal size=20><i>"returns a number less than limit."</i><p>
<spacer type=horizontal size=20>| retval |<br>
<spacer type=horizontal size=20>(limit isKindOf: Point)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^self pointLessThan: limit].<br>
<spacer type=horizontal size=20>retval := R next * limit.<br>
<spacer type=horizontal size=20>(limit isKindOf: Integer)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [retval := retval truncated].<br>
<spacer type=horizontal size=20>^retval</dd>
<p><hr width=50 align=left><p>
<dd>
<b>pointBetween: left and: right <br></b>
<spacer type=horizontal size=20><i>"returns an Point value between left and right, inclusive. You can pass Points to between:and: if you <br>
<spacer type=horizontal size=20>like, since it just calls this."</i><p>
<spacer type=horizontal size=20>^Point x: (self between: left x and: right x)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>y: (self between: left y and: right y)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>pointLessThan: limit <br></b>
<spacer type=horizontal size=20><i>"returns a Point less than limit. The limit is itself a Point. You can send Points to lessThan: if you <br>
<spacer type=horizontal size=20>want, since it just calls this."</i><p>
<spacer type=horizontal size=20>^Point x: (self lessThan: limit x)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>y: (self lessThan: limit y)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>pointOutside: aRectangle by: limit <br></b>
<spacer type=horizontal size=20><i>"returns a Point just outside aRectangle. Limit may be a scalar or a Point."</i><br>
<spacer type=horizontal size=20><i>"This looks like a mess... I wonder if there's a better way to do this."</i><p>
<spacer type=horizontal size=20>| xLimit yLimit select |<br>
<spacer type=horizontal size=20>(limit isKindOf: Point)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[xLimit := limit x.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>yLimit := limit y]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[xLimit := limit.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>yLimit := limit].<br>
<spacer type=horizontal size=20>select := self between: 1 and: 8.<br>
<spacer type=horizontal size=20>select = 1 ifTrue: [^self between: aRectangle left - xLimit @ (aRectangle top - yLimit) and: aRectangle left @ aRectangle top].<br>
<spacer type=horizontal size=20>select = 2 ifTrue: [^self between: aRectangle left @ (aRectangle top - yLimit) and: aRectangle right @ aRectangle top].<br>
<spacer type=horizontal size=20>select = 3 ifTrue: [^self between: aRectangle right @ (aRectangle top - yLimit) and: aRectangle right + xLimit @ aRectangle top].<br>
<spacer type=horizontal size=20>select = 4 ifTrue: [^self between: aRectangle left - xLimit @ aRectangle top and: aRectangle left @ aRectangle bottom].<br>
<spacer type=horizontal size=20>select = 5 ifTrue: [^self between: aRectangle right + xLimit @ aRectangle top and: aRectangle right + xLimit @ aRectangle bottom].<br>
<spacer type=horizontal size=20>select = 6 ifTrue: [^self between: aRectangle left - xLimit @ aRectangle bottom and: aRectangle left @ (aRectangle bottom + yLimit)].<br>
<spacer type=horizontal size=20>select = 7 ifTrue: [^self between: aRectangle left @ aRectangle bottom and: aRectangle right @ (aRectangle bottom + yLimit)].<br>
<spacer type=horizontal size=20>select = 8 ifTrue: [^self between: aRectangle right @ aRectangle bottom and: aRectangle right + xLimit @ (aRectangle bottom + yLimit)].<br>
<spacer type=horizontal size=20>self error: 'pointOutside failed to select an option'</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>class initialization</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"set up the random number generator"</i><p>
<spacer type=horizontal size=20>R := Random new</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"don't create instances of this class. use the class methods for access."</i><p>
<spacer type=horizontal size=20>self shouldNotImplement</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class Ship
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Sprite
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'direction shipShape thrustingShape player hypercount '<br>
<spacer type=horizontal size=20>classVariableNames: 'MaxVelocity MinVelocity Radius ShipShape ShipThrustShape TurnIncrement '<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>A spaceship sprite.<p>
Instance variables:<br>
<spacer type=horizontal size=20>direction &lt;Number&gt; Direction (radians) in which the ship is facing.<br>
<spacer type=horizontal size=20>shipShape &lt;Polyline&gt; the shape used when the ship isn't thrusting<br>
<spacer type=horizontal size=20>thrustingShape &lt;Polyline&gt; the shape used when the ship is thrusting<br>
<spacer type=horizontal size=20>player &lt;Player&gt; the player associated with this ship<br>
<spacer type=horizontal size=20>hypercount &lt;Number&gt; the number of update cycles before the ship comes out of hyperspace<p>
Class Variables:<br>
<spacer type=horizontal size=20>MaxVelocity &lt;Number&gt; maximum allowable velocity (constant)<br>
<spacer type=horizontal size=20>MinVelocity &lt;Number&gt; velocity below which the velocity becomes zero (constant)<br>
<spacer type=horizontal size=20>Radius &lt;Number&gt; Radius of the ship (constant)<br>
<spacer type=horizontal size=20>ShipShape &lt;OrderedCollection&gt; Collection of points that define the shape of a ship.<br>
<spacer type=horizontal size=20>ShipThrustShape &lt;OrderedCollection&gt; Collection of points that define the shape of a thrusting ship</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>direction<br></b>
<spacer type=horizontal size=20><i>"answer the current direction of the ship"</i><p>
<spacer type=horizontal size=20>^direction</dd>
<p><hr width=50 align=left><p>
<dd>
<b>ownedBy: aPlayer <br></b>
<spacer type=horizontal size=20><i>"let aPlayer own the receiver"</i><p>
<spacer type=horizontal size=20>player := aPlayer</dd>
<p><hr width=50 align=left><p>
<dd>
<b>player<br></b>
<spacer type=horizontal size=20><i>"answers the player who owns the receiver"</i><p>
<spacer type=horizontal size=20>^player</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>collision detection</b></u><p>
<dd>
<b>isCollidingWith: aSprite <br></b>
<spacer type=horizontal size=20><i>"returns true if the receiver is colliding with a sprite"</i><p>
<spacer type=horizontal size=20>| isHit |<br>
<spacer type=horizontal size=20>(aSprite isMemberOf: FlamingBit)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^false].<br>
<spacer type=horizontal size=20>(aSprite isMemberOf: Bullet)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^false].<br>
<spacer type=horizontal size=20>aSprite isVisible ifFalse: [^false].<br>
<spacer type=horizontal size=20>isHit := (shape translatedBy: location)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>regionIntersects: aSprite collisionCheckRectangle.<br>
<spacer type=horizontal size=20>isHit ifTrue: [player award: aSprite pointValue].<br>
<spacer type=horizontal size=20>^isHit</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>controls</b></u><p>
<dd>
<b>fire<br></b>
<spacer type=horizontal size=20><i>"fire a shot."</i><p>
<spacer type=horizontal size=20>self isVisible ifTrue: [world add: (Bullet parent: self)]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>hyperspace<br></b>
<spacer type=horizontal size=20><i>"jump into hyperspace"</i><p>
<spacer type=horizontal size=20>self isVisible<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[self hide.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>hypercount := 30]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>thrust<br></b>
<spacer type=horizontal size=20><i>"increase ship speed"</i><p>
<spacer type=horizontal size=20>self isVisible<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[acceleration := acceleration + (Point r: 0.3 theta: direction).<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>acceleration := Point r: (acceleration r max: 1.5)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>theta: acceleration theta.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[shape := thrustingShape.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(Delay forMilliseconds: 100) wait.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>shape := shipShape] fork]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>turnLeft<br></b>
<spacer type=horizontal size=20><i>"Turn the ship left"</i><p>
<spacer type=horizontal size=20>self isVisible<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[direction := direction - TurnIncrement \\ 6.28318.<spacer type=horizontal size=20><i>"mod 2 pi"</i><br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self rotate: 0 - TurnIncrement]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>turnRight<br></b>
<spacer type=horizontal size=20><i>"Turn the ship right"</i><p>
<spacer type=horizontal size=20>self isVisible<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[direction := direction + TurnIncrement \\ 6.28318.<spacer type=horizontal size=20><i>"mod 2 pi"</i><br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self rotate: 0 + TurnIncrement]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"initialize the receiver"</i><p>
<spacer type=horizontal size=20>super initialize.<br>
<spacer type=horizontal size=20>shipShape := Polyline vertices: ShipShape copy.<br>
<spacer type=horizontal size=20>thrustingShape := Polyline vertices: ShipThrustShape copy.<br>
<spacer type=horizontal size=20>shape := shipShape.<br>
<spacer type=horizontal size=20>hypercount := 0.<br>
<spacer type=horizontal size=20>direction := -1.571.<br>
<spacer type=horizontal size=20>self rotate: -1.571</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>transforming</b></u><p>
<dd>
<b>rotate: angle <br></b>
<spacer type=horizontal size=20><i>"rotate the ship by an angle (in radians)"</i><p>
<spacer type=horizontal size=20>angle isZero<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[1 to: shipShape vertices size<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[:i | <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>| p |<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>p := shipShape vertices.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>shipShape vertices at: i put: (Point r: (p at: i) r theta: (p at: i) theta + angle)].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>1 to: thrustingShape vertices size<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[:i | <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>| p |<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>p := thrustingShape vertices.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>thrustingShape vertices at: i put: (Point r: (p at: i) r theta: (p at: i) theta + angle)]]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>updating</b></u><p>
<dd>
<b>update<br></b>
<spacer type=horizontal size=20><i>"update the parameters of the ship"</i><p>
<spacer type=horizontal size=20>hypercount &gt; 0<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[hypercount := hypercount - 1.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>hypercount = 0<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[self moveTo: (RandomNumber pointLessThan: Asteroids windowSize).<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self velocity: 0 @ 0.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self acceleration: 0 @ 0.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self unHide]]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[super update.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>acceleration := acceleration / 1.5.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>velocity := velocity / 1.02.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>velocity r &gt; MaxVelocity ifTrue: [velocity := Point r: MaxVelocity theta: velocity theta].<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>velocity r &lt; MinVelocity ifTrue: [velocity := 0 @ 0]]</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>radius<br></b>
<spacer type=horizontal size=20><i>"answers the radius of a ship."</i><p>
<spacer type=horizontal size=20>^Radius</dd>
<p><hr width=50 align=left><p>
<dd>
<b>shipShape<br></b>
<spacer type=horizontal size=20><i>"answers the collection of points that defines a ship's shape"</i><p>
<spacer type=horizontal size=20>^ShipShape</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>class initialization</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"set up class constants"</i><p>
<spacer type=horizontal size=20>Asteroids initialize.<br>
<spacer type=horizontal size=20>MaxVelocity := 80.<br>
<spacer type=horizontal size=20>MinVelocity := 0.5.<br>
<spacer type=horizontal size=20>TurnIncrement := 0.261799.<br>
<spacer type=horizontal size=20>Radius := 30 * Asteroids spriteScaleFactor.<br>
<spacer type=horizontal size=20>ShipShape := OrderedCollection new.<br>
<spacer type=horizontal size=20>ShipShape add: (Point r: Radius theta: 0).<br>
<spacer type=horizontal size=20>ShipShape add: (Point r: Radius theta: 2.356).<br>
<spacer type=horizontal size=20>ShipShape add: (Point r: Radius / 2 theta: 3.142).<br>
<spacer type=horizontal size=20>ShipShape add: (Point r: Radius theta: 3.927).<br>
<spacer type=horizontal size=20>ShipShape add: (Point r: Radius theta: 0).<br>
<spacer type=horizontal size=20>ShipThrustShape := ShipShape copy.<br>
<spacer type=horizontal size=20>ShipThrustShape add: (Point r: Radius theta: 2.356).<br>
<spacer type=horizontal size=20>ShipThrustShape add: ((Point r: Radius theta: 3)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>nearestPointOnLineFrom: (Point r: Radius theta: 2.356)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>to: (Point r: Radius / 2 theta: 3.142)).<br>
<spacer type=horizontal size=20>ShipThrustShape add: (Point r: Radius * 1.3 theta: 3.142).<br>
<spacer type=horizontal size=20>ShipThrustShape add: ((Point r: Radius theta: 3.283)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>nearestPointOnLineFrom: (Point r: Radius theta: 3.927)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>to: (Point r: Radius / 2 theta: 3.142))</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class Spaceship
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Sprite
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'direction pointValue '<br>
<spacer type=horizontal size=20>classVariableNames: 'ShipShape '<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>The spaceship sprite. These are the aliens that come out and shoot you down.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>direction &lt;Number&gt; a number that represents whether the spaceship is going left-to-right (positive) or right-to-left (negative)</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>pointValue<br></b>
<spacer type=horizontal size=20><i>"answers the point value of the ship"</i><p>
<spacer type=horizontal size=20>^pointValue</dd>
<p><hr width=50 align=left><p>
<dd>
<b>pointValue: pv<br></b>
<spacer type=horizontal size=20><i>"sets the point value of the receiver"</i><p>
<spacer type=horizontal size=20>pointValue := pv</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>collision checking</b></u><p>
<dd>
<b>checkForCollision<br></b>
<spacer type=horizontal size=20><i>"check for collisions with the sprites in the world"</i><p>
<spacer type=horizontal size=20>^nil</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isCollidingWith: aSprite <br></b>
<spacer type=horizontal size=20><i>"returns true if the receiver is colliding with a sprite"</i><p>
<spacer type=horizontal size=20>^false</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20>super initialize.<br>
<spacer type=horizontal size=20>direction := 10.<br>
<spacer type=horizontal size=20>(RandomNumber chance: 0.5)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [self moveTo: (RandomNumber between: Asteroids windowBounds left - direction @ Asteroids windowBounds top and: Asteroids windowBounds left - direction @ Asteroids windowBounds bottom)]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[direction := direction negated.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>self moveTo: (RandomNumber between: Asteroids windowBounds right - direction @ Asteroids windowBounds top and: Asteroids windowBounds right - direction @ Asteroids windowBounds bottom)].<br>
<spacer type=horizontal size=20>self changeVelocity</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>testing</b></u><p>
<dd>
<b>hasEscaped<br></b>
<spacer type=horizontal size=20><i>"answers whether the receiver has reached the other side of the screen."</i><p>
<spacer type=horizontal size=20>direction &gt; 0<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^location x &gt; (Asteroids windowSize x + direction)]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [^location x &lt; direction]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>transforming</b></u><p>
<dd>
<b>changeVelocity<br></b>
<spacer type=horizontal size=20><i>"do a dodge"</i><p>
<spacer type=horizontal size=20>velocity := Point x: direction y: (RandomNumber between: -20 and: 20)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>takeAShot<br></b>
<spacer type=horizontal size=20><i>"fire a shot."</i><p>
<spacer type=horizontal size=20>world add: (Bullet parent: self)</dd>
<p><hr width=50 align=left><p>
<dd>
<b>update<br></b>
<spacer type=horizontal size=20><i>"update the parameters of the sprite"</i><p>
<spacer type=horizontal size=20>super update.<br>
<spacer type=horizontal size=20>(RandomNumber chance: 0.05)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [self changeVelocity].<br>
<spacer type=horizontal size=20>(RandomNumber chance: 0.05)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [self takeAShot].<br>
<spacer type=horizontal size=20>self hasEscaped ifTrue: [self destroy]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>wrap<br></b>
<spacer type=horizontal size=20><i>"wrap around to the other side of the window"</i><p>
<spacer type=horizontal size=20>| height windowHeight |<br>
<spacer type=horizontal size=20>height := shape asRectangle height.<br>
<spacer type=horizontal size=20>windowHeight := Asteroids windowSize y + height.<br>
<spacer type=horizontal size=20>location y: location y + (height / 2) \\ windowHeight - (height / 2)</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>class initialization</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"sets up the spaceship shape"</i><p>
<spacer type=horizontal size=20>| hemisphere returnPoint domeWidth |<br>
<spacer type=horizontal size=20>ShipShape := OrderedCollection new.<br>
<spacer type=horizontal size=20>hemisphere := (Circle center: 0 @ 0 radius: 120) asPolyline vertices select: [:p | p y &lt; -35].<br>
<spacer type=horizontal size=20>ShipShape addAll: hemisphere.<br>
<spacer type=horizontal size=20>ShipShape add: hemisphere first.<br>
<spacer type=horizontal size=20>domeWidth := hemisphere first dist: hemisphere last.<br>
<spacer type=horizontal size=20>ShipShape add: ShipShape last + (-50 @ 50).<br>
<spacer type=horizontal size=20>returnPoint := ShipShape last + (domeWidth + 100 @ 0).<br>
<spacer type=horizontal size=20>ShipShape add: returnPoint.<br>
<spacer type=horizontal size=20>ShipShape add: hemisphere last.<br>
<spacer type=horizontal size=20>ShipShape add: returnPoint.<br>
<spacer type=horizontal size=20>ShipShape add: ShipShape last + (-50 @ 0).<br>
<spacer type=horizontal size=20>ShipShape add: ShipShape last + (-25 @ 25).<br>
<spacer type=horizontal size=20>ShipShape add: ShipShape last + (50 - domeWidth @ 0).<br>
<spacer type=horizontal size=20>ShipShape add: ShipShape last + (-25 @ -25)</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>large<br></b>
<spacer type=horizontal size=20><i>"answers a new large spaceship"</i><p>
<spacer type=horizontal size=20>^(super new initialize shape: ((Polyline vertices: ShipShape)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>scaledBy: 1 / 5 * Asteroids spriteScaleFactor))<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>pointValue: 200</dd>
<p><hr width=50 align=left><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"answers a new large spaceship"</i><p>
<spacer type=horizontal size=20>^self large</dd>
<p><hr width=50 align=left><p>
<dd>
<b>small<br></b>
<spacer type=horizontal size=20><i>"answers a new small spaceship"</i><p>
<spacer type=horizontal size=20>^(super new initialize shape: ((Polyline vertices: ShipShape)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>scaledBy: 1 / 8 * Asteroids spriteScaleFactor))<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>pointValue: 1000</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class Sprite
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'shape location velocity acceleration angular_speed state color world '<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>This is the superclass of all the sprites in Asteroids.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>shape &lt;Polyline&gt; The graphical object that represents the geometry of the sprite.<br>
<spacer type=horizontal size=20>location &lt;Point&gt; x,y coordinates of the center of the sprite<br>
<spacer type=horizontal size=20>velocity &lt;Point&gt; Add this to location at each update<br>
<spacer type=horizontal size=20>acceleration &lt;Point&gt; Add this to velocity at each update<br>
<spacer type=horizontal size=20>angular_speed &lt;Number&gt; rotate the sprite by this much at each update<br>
<spacer type=horizontal size=20>state &lt;Object&gt; Can be #visible, #hidden, or #destroyed<br>
<spacer type=horizontal size=20>color &lt;ColorValue&gt; color of the sprite<br>
<spacer type=horizontal size=20>world &lt;SpriteWorld&gt; the world (set of sprites) in which this sprite lives</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>acceleration<br></b>
<spacer type=horizontal size=20><i>"answer the acceleration of the receiver"</i><p>
<spacer type=horizontal size=20>^acceleration</dd>
<p><hr width=50 align=left><p>
<dd>
<b>acceleration: accel <br></b>
<spacer type=horizontal size=20><i>"set the acceleration of the receiver"</i><p>
<spacer type=horizontal size=20>acceleration := accel</dd>
<p><hr width=50 align=left><p>
<dd>
<b>angular_speed<br></b>
<spacer type=horizontal size=20><i>"answer the angular speed of the receiver"</i><p>
<spacer type=horizontal size=20>^angular_speed</dd>
<p><hr width=50 align=left><p>
<dd>
<b>angular_speed: speed <br></b>
<spacer type=horizontal size=20><i>"set the angular speed of the receiver"</i><p>
<spacer type=horizontal size=20>angular_speed := speed</dd>
<p><hr width=50 align=left><p>
<dd>
<b>area<br></b>
<spacer type=horizontal size=20><i>"answer the area of the receiver"</i><br>
<spacer type=horizontal size=20><i>"this is used in momentum calculations"</i><p>
<spacer type=horizontal size=20>^shape bounds area</dd>
<p><hr width=50 align=left><p>
<dd>
<b>color<br></b>
<spacer type=horizontal size=20><i>"answers the receiver's color"</i><p>
<spacer type=horizontal size=20>^color</dd>
<p><hr width=50 align=left><p>
<dd>
<b>color: c <br></b>
<spacer type=horizontal size=20><i>"set the receiver's color"</i><p>
<spacer type=horizontal size=20>color := c</dd>
<p><hr width=50 align=left><p>
<dd>
<b>location<br></b>
<spacer type=horizontal size=20><i>"answer the location of the receiver"</i><p>
<spacer type=horizontal size=20>^location</dd>
<p><hr width=50 align=left><p>
<dd>
<b>pointValue<br></b>
<spacer type=horizontal size=20><i>"answer the point value of the receiver"</i><p>
<spacer type=horizontal size=20>^0</dd>
<p><hr width=50 align=left><p>
<dd>
<b>shape<br></b>
<spacer type=horizontal size=20><i>"answer the shape of the receiver"</i><p>
<spacer type=horizontal size=20>^shape</dd>
<p><hr width=50 align=left><p>
<dd>
<b>shape: s <br></b>
<spacer type=horizontal size=20><i>"set the shape of the receiver"</i><p>
<spacer type=horizontal size=20>shape := s</dd>
<p><hr width=50 align=left><p>
<dd>
<b>state<br></b>
<spacer type=horizontal size=20><i>"answers the state of the receiver. Normally this will be #visible, #hidden, or #destroyed"</i><p>
<spacer type=horizontal size=20>^state</dd>
<p><hr width=50 align=left><p>
<dd>
<b>velocity<br></b>
<spacer type=horizontal size=20><i>"answer the velocity of the receiver"</i><p>
<spacer type=horizontal size=20>^velocity</dd>
<p><hr width=50 align=left><p>
<dd>
<b>velocity: speed<br></b>
<spacer type=horizontal size=20><i>"set the velocity of the receiver"</i><p>
<spacer type=horizontal size=20>velocity := speed</dd>
<p><hr width=50 align=left><p>
<dd>
<b>world<br></b>
<spacer type=horizontal size=20><i>"answers the SpriteWorld in which the receiver lives"</i><p>
<spacer type=horizontal size=20>^world</dd>
<p><hr width=50 align=left><p>
<dd>
<b>world: aSpriteWorld <br></b>
<spacer type=horizontal size=20><i>"put the receiver into aSpriteWorld"</i><p>
<spacer type=horizontal size=20>world := aSpriteWorld</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>collision detection</b></u><p>
<dd>
<b>checkForCollision<br></b>
<spacer type=horizontal size=20><i>"check for collisions between the receiver and the sprites in the receiver's world"</i><p>
<spacer type=horizontal size=20>| retblock |<br>
<spacer type=horizontal size=20>retblock := [^nil].<br>
<spacer type=horizontal size=20>world do: [:s | s = self ifFalse: [s isVisible ifTrue: [(self isCollidingWith: s)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[self impact: s.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>retblock value]]]]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>collisionCheckRectangle<br></b>
<spacer type=horizontal size=20><i>"answers a Rectangle that can be used when checking for collisions"</i><p>
<spacer type=horizontal size=20>self isVisible<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [^(shape translatedBy: location) asRectangle]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [^Rectangle origin: -9999 @ -9999 extent: 0 @ 0]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isClear<br></b>
<spacer type=horizontal size=20><i>"returns true if none of the sprites in the world are near."</i><p>
<spacer type=horizontal size=20>| retblock |<br>
<spacer type=horizontal size=20>retblock := [^false].<br>
<spacer type=horizontal size=20>world do: [:s | s = self ifFalse: [s isVisible ifTrue: [(s collisionCheckRectangle intersects: ((shape asRectangle scaledBy: 3)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>translatedBy: location))<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [retblock value]]]].<br>
<spacer type=horizontal size=20>^true</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isCollidingWith: aSprite <br></b>
<spacer type=horizontal size=20><i>"returns true if the receiver is colliding with a sprite"</i><p>
<spacer type=horizontal size=20>self isVisible ifFalse: [^false].<br>
<spacer type=horizontal size=20>^(shape translatedBy: location)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>regionIntersects: aSprite collisionCheckRectangle</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>displaying</b></u><p>
<dd>
<b>displayOn: aGraphicsContext <br></b>
<spacer type=horizontal size=20><i>"display the sprite on aGraphicsContext"</i><p>
<spacer type=horizontal size=20>self isVisible<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[aGraphicsContext paint: self color.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>(shape translatedBy: location)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>displayStrokedOn: aGraphicsContext]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"initialize the parameters of the sprite"</i><p>
<spacer type=horizontal size=20>state := #visible.<br>
<spacer type=horizontal size=20>shape := nil.<br>
<spacer type=horizontal size=20>color := ColorValue white.<br>
<spacer type=horizontal size=20>location := 0 @ 0.<br>
<spacer type=horizontal size=20>velocity := 0 @ 0.<br>
<spacer type=horizontal size=20>acceleration := 0 @ 0.<br>
<spacer type=horizontal size=20>angular_speed := 0.<br>
<spacer type=horizontal size=20>world := nil</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>testing</b></u><p>
<dd>
<b>isDestroyed<br></b>
<spacer type=horizontal size=20><i>"answers true if the receiver has been destroyed"</i><p>
<spacer type=horizontal size=20>^state = #destroyed</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isHidden<br></b>
<spacer type=horizontal size=20><i>"answers true if the receiver is hidden"</i><p>
<spacer type=horizontal size=20>^state = #hidden</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isOffscreen<br></b>
<spacer type=horizontal size=20><i>"answers true if the object is off the screen."</i><p>
<spacer type=horizontal size=20>^((shape translatedBy: location)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>outlineIntersects: Asteroids windowBounds) not</dd>
<p><hr width=50 align=left><p>
<dd>
<b>isVisible<br></b>
<spacer type=horizontal size=20><i>"answers true if the receiver is visible"</i><p>
<spacer type=horizontal size=20>^state = #visible</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>transforming</b></u><p>
<dd>
<b>addFlamingBits<br></b>
<spacer type=horizontal size=20><i>"adds a collection of sprites that are the exploded remains of the receiver to the receiver's world"</i><p>
<spacer type=horizontal size=20>shape edgesDo: [:p1 :p2 | (RandomNumber chance: 0.70)<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [world add: (FlamingBit<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>from: p1<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>to: p2<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>at: location<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>velocity: velocity)]]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>destroy<br></b>
<spacer type=horizontal size=20><i>"destroy the receiver"</i><p>
<spacer type=horizontal size=20>state := #destroyed</dd>
<p><hr width=50 align=left><p>
<dd>
<b>hide<br></b>
<spacer type=horizontal size=20><i>"make receiver invisible, but don't destroy it."</i><p>
<spacer type=horizontal size=20>self isVisible ifTrue: [state := #hidden]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>impact: aSprite <br></b>
<spacer type=horizontal size=20><i>"run the receiver into a sprite, modifying both sprites' velocities."</i><p>
<spacer type=horizontal size=20>| myOldVelocity |<br>
<spacer type=horizontal size=20>myOldVelocity := self velocity.<br>
<spacer type=horizontal size=20>self velocity: self velocity + (aSprite velocity * aSprite area / self area / 3).<br>
<spacer type=horizontal size=20>aSprite velocity: aSprite velocity + (myOldVelocity * self area / aSprite area / 3).<br>
<spacer type=horizontal size=20>self addFlamingBits.<br>
<spacer type=horizontal size=20>aSprite addFlamingBits.<br>
<spacer type=horizontal size=20>self destroy.<br>
<spacer type=horizontal size=20>aSprite destroy</dd>
<p><hr width=50 align=left><p>
<dd>
<b>moveTo: aPoint <br></b>
<spacer type=horizontal size=20><i>"set the location of the sprite"</i><p>
<spacer type=horizontal size=20>aPoint = #offscreen<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifTrue: [location := RandomNumber pointOutside: Asteroids windowBounds by: shape asRectangle extent]<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20>ifFalse: [location := aPoint]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>rotate: angle <br></b>
<spacer type=horizontal size=20><i>"rotate the sprite by an angle (in radians)"</i><p>
<spacer type=horizontal size=20>angle isZero ifFalse: [1 to: shape vertices size<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>do: <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>[:i | <br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>| p |<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>p := shape vertices.<br>
<spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20><spacer type=horizontal size=20>shape vertices at: i put: (Point r: (p at: i) r theta: (p at: i) theta + angle)]]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>unHide<br></b>
<spacer type=horizontal size=20><i>"make receiver visible"</i><p>
<spacer type=horizontal size=20>self isHidden ifTrue: [state := #visible]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>wrap<br></b>
<spacer type=horizontal size=20><i>"wrap the receiver around to the other side of the window"</i><p>
<spacer type=horizontal size=20>| width height windowWidth windowHeight |<br>
<spacer type=horizontal size=20>width := shape asRectangle width.<br>
<spacer type=horizontal size=20>height := shape asRectangle height.<br>
<spacer type=horizontal size=20>windowWidth := Asteroids windowSize x + width.<br>
<spacer type=horizontal size=20>windowHeight := Asteroids windowSize y + height.<br>
<spacer type=horizontal size=20>location x: location x + (width / 2) \\ windowWidth - (width / 2).<br>
<spacer type=horizontal size=20>location y: location y + (height / 2) \\ windowHeight - (height / 2)</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>updating</b></u><p>
<dd>
<b>update<br></b>
<spacer type=horizontal size=20><i>"update the parameters of the sprite. move the sprite to its new location, rotate it, and check for <br>
<spacer type=horizontal size=20>collisions"</i><p>
<spacer type=horizontal size=20>self rotate: angular_speed.<br>
<spacer type=horizontal size=20>self moveTo: location + velocity.<br>
<spacer type=horizontal size=20>self isOffscreen ifTrue: [self wrap].<br>
<spacer type=horizontal size=20>self velocity: velocity + acceleration.<br>
<spacer type=horizontal size=20>self isVisible ifTrue: [self checkForCollision]</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>at: location <br></b>
<spacer type=horizontal size=20><i>"answers a new sprite at location"</i><p>
<spacer type=horizontal size=20>| newSprite |<br>
<spacer type=horizontal size=20>newSprite := super new initialize.<br>
<spacer type=horizontal size=20>newSprite moveTo: location.<br>
<spacer type=horizontal size=20>^newSprite</dd>
<p><hr width=50 align=left><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20><i>"answers a new sprite"</i><p>
<spacer type=horizontal size=20>^self at: 0 @ 0</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class SpriteLink
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Link
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'sprite '<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>Instances of SpriteLink are used as nodes in LinkedLists of Sprites.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>sprite &lt;Sprite&gt; the sprite value</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>accessing</b></u><p>
<dd>
<b>sprite<br></b>
<spacer type=horizontal size=20><i>"answers the sprite held in the receiver"</i><p>
<spacer type=horizontal size=20>^sprite</dd>
<p><hr width=50 align=left><p>
<dd>
<b>sprite: aSprite <br></b>
<spacer type=horizontal size=20><i>"sets the receiver's sprite slot"</i><p>
<spacer type=horizontal size=20>sprite := aSprite</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<i>(none)</i><p>&nbsp;<p>
<p><spacer type=vertical size=50>
<table border=1 width=95% cellpadding=10>
<tr>
<td width=50% align=left>
<b><big>
Class SpriteWorld
</b></big>
</td>
<td align=right>
<big><b>Superclass:</b></big>
Object
</td>
</tr>
<tr>
<td colspan=2 align=left>
<spacer type=horizontal size=20>instanceVariableNames: 'sprites '<br>
<spacer type=horizontal size=20>classVariableNames: ''<br>
<spacer type=horizontal size=20>poolDictionaries: ''<br>
<spacer type=horizontal size=20>category: 'Asteroids'</td>
</tr>
<tr>
<td colspan=2 align=left>
<i>Instances of SpriteWorld hold a collection of sprites.<p>
Instance Variables:<br>
<spacer type=horizontal size=20>sprites &lt;MyLinkedList&gt; the sprites contained in the world</i>
</td>
</tr>
</table>
<p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
instance methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>adding-removing</b></u><p>
<dd>
<b>add: aSprite <br></b>
<spacer type=horizontal size=20><i>"add a sprite to the world"</i><p>
<spacer type=horizontal size=20>sprites add: (SpriteLink new sprite: (aSprite world: self))</dd>
<p><hr width=50 align=left><p>
<dd>
<b>addAll: aCollection <br></b>
<spacer type=horizontal size=20><i>"add a collection of sprites to the world"</i><p>
<spacer type=horizontal size=20>aCollection do: [:s | self add: s]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>destroyAll<br></b>
<spacer type=horizontal size=20><i>"destroy all sprites in the receiver"</i><p>
<spacer type=horizontal size=20>self do: [:s | s destroy]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>displaying</b></u><p>
<dd>
<b>displayOn: aGraphicsContext <br></b>
<spacer type=horizontal size=20><i>"display the receiver's sprites on aGraphicsContext"</i><p>
<spacer type=horizontal size=20>self do: [:s | s displayOn: aGraphicsContext]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>enumerating</b></u><p>
<dd>
<b>do: aBlock <br></b>
<spacer type=horizontal size=20><i>"Evaluate aBlock with each of the receiver's elements as the argument."</i><p>
<spacer type=horizontal size=20>sprites do: [:l | aBlock value: l sprite]</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>initialize-release</b></u><p>
<dd>
<b>initialize<br></b>
<spacer type=horizontal size=20><i>"initialize the receiver"</i><p>
<spacer type=horizontal size=20>sprites := MyLinkedList new</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>testing</b></u><p>
<dd>
<b>isEmpty<br></b>
<spacer type=horizontal size=20><i>"answers true if there are no sprites in the world"</i><p>
<spacer type=horizontal size=20>^sprites isEmpty</dd>
<p>
</dl><p>&nbsp;<p>
<dl>
<dt>
<u><b>updating</b></u><p>
<dd>
<b>removeDestroyedSprites<br></b>
<spacer type=horizontal size=20><i>"remove sprites that are destroyed from the receiver"</i><p>
<spacer type=horizontal size=20>sprites removeIf: [:l | l sprite isDestroyed]</dd>
<p><hr width=50 align=left><p>
<dd>
<b>update<br></b>
<spacer type=horizontal size=20><i>"update each of the receiver's sprites and remove destroyed sprites"</i><p>
<spacer type=horizontal size=20>self do: [:s | s update].<br>
<spacer type=horizontal size=20>self removeDestroyedSprites</dd>
<p>
</dl><p>&nbsp;<p>
<hr>
<big><b><spacer type=horizontal size=10>
class methods
</b></big><br>
<hr>
<p>
<dl>
<dt>
<u><b>instance creation</b></u><p>
<dd>
<b>new<br></b>
<spacer type=horizontal size=20>^super new initialize</dd>
<p>
</dl><p>&nbsp;<p>
<p><spacer type=vertical size=50>
</BODY>
<HTML>
